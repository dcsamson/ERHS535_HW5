---
title: "Samson_HW5"
author: "Danielle Samson"
date: "2025-12-01"
output:
  html_document: default
  pdf_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning= FALSE, message= FALSE, error= FALSE)
```

## Choose a city to work with
In the following chunk, I read in the data, looked through the list of potential cities then decided to work with Denver. I then filtered the dataset to include only the data from Denver and used the provided coordinates to turn the dataframe into a simple feature object. Finally, I generated the plot to help visualize where I am and where I need to go with my code
```{r choose a city}
library(tidyverse)
library(sf)
library(tigris)
library(ggthemes)
#read in the data

homicides <- read.csv("homicide-data.csv")

#choose a city

print(unique(homicides$city))

denver_homicides <- homicides %>%
  filter(city == 'Denver') %>% 
  st_as_sf(coords = c("lon", "lat"),
               crs = 4269)

#evaluate the current plot

denver_homicides %>%
  ggplot() +
  geom_sf()
```

## Input city boundaries
In this chunk, I took the Colorado geometry from the tigris package and then filtered the data to include only Denver. Looking back, I think I could have done this in one step by immediately filtering by the NAME column. Again, I checked in on the plot
```{r results='hide'}
#extract denver boundaries from tigris
places <- tigris::places(state = "CO",
                                    cb = FALSE,
                                    year = "2024")
denver_boundaries <- places %>%
  filter(NAME == "Denver")
```

```{r evaluate the current plot}
denver_boundaries %>%
  ggplot() +
  geom_sf()

```

## Align Geometries
In this chunk, I ensure that my geometries align before continuing to manipulate my dataset
```{r ensure geometry alignment}

ggplot() +
  geom_sf(data = denver_boundaries) +
  geom_sf(data = denver_homicides)
```


## Factor Lump to Most Murdered Races
In this chunk, I convert the victim_race column to a factor to be used with the fct_lump function to highlight the races with the most murders. I then visualize the status of the plot
```{r}
denver_victim_races <- denver_homicides %>%
  mutate(victim_race = as.factor(victim_race)) %>%
  mutate(victim_race = fct_lump(victim_race, n = 3))

ggplot() +
  geom_sf(data = denver_boundaries) +
  geom_sf(data = denver_victim_races, aes(color = victim_race)) 


```

## Unsolved cases
In this chunk, I create a new column to sort the cases by solved vs unsolved
```{r}
#solved vs unsolved columns
case_status <- denver_victim_races %>%
  mutate(solved = ifelse(disposition %in% c("Closed without arrest", "Closed by arrest"), "Solved", "Unsolved"))
```

## Final Plot
This chunk generates the final plot with maps separated by solved and unsolved cases
```{r fig.width= 15, fig.height= 10}
ggplot() +
  geom_sf(data = denver_boundaries) +
  geom_sf(data = case_status, aes(color = victim_race), alpha = 0.5) +
  facet_wrap("solved") +
  theme_stata() + 
  labs(
    title = "Denver Homicides by Race", 
    color = "Victim Race"
  )

```



























